<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2025ë…„ ì¶”ê³„ ê³„ëª¨ì„ ì°¸ì„ í˜„í™©</title>
  <!-- React via CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin:0; padding:0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif; }
  </style>

  <!-- Firebase (compat for simplicity in single-file) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useEffect, useMemo, useRef, useState } = React;

    // Lucide-like SVG icons
    const CheckCircle = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    );
    const XCircle = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    );
    const Users = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
      </svg>
    );
    const Calendar = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
      </svg>
    );

    // ===== Firebase Init (fill these placeholders) =====
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
    };
    let firestore = null;
    let authReady = false;
    try {
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const auth = firebase.auth();
      firestore = firebase.firestore();
      auth.signInAnonymously().then(()=>{ authReady = true; }).catch(console.error);
    } catch (e) {
      console.error('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
    }
    // ================================================

    function MeetingAttendance() {
      const [members, setMembers] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState('');

      const DEFAULT_MEMBERS = [
        'ì´ê²½ë“','ì´ê²½ë¥ ','ê¹€ì£¼ì‹','ì´ê²½ì„','ë°˜ë³‘ì£¼','ì •ì„±ëŒ€','ì´ê²½í˜¸',
        'ê¹€ê¸ˆìˆœ','ì´ì¬ì„±','ì´ë™ê´€','í•œì„ì›','ê°•ì–‘ìˆ˜','í™©ë‘í˜¸','ì´ì„±ê·¼','ì´ê²½ìˆ˜','ì´ê²½ì² '
      ].map((name, i) => ({ id: i+1, name, attendance:'', count:'', note:'' }));

      const collectionName = 'attendance_2025';
      const docId = 'autumn';

      const saveTimer = useRef(null);

      useEffect(() => {
        let unsub = null;
        (async () => {
          if (!firestore) {
            setError('âš ï¸ Firebase ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. ìƒë‹¨ ìŠ¤í¬ë¦½íŠ¸ì˜ firebaseConfig ê°’ì„ ì±„ì›Œì£¼ì„¸ìš”.');
            setMembers(DEFAULT_MEMBERS);
            setLoading(false);
            return;
          }
          try {
            const ref = firestore.collection(collectionName).doc(docId);
            const snap = await ref.get();
            if (!snap.exists) {
              await ref.set({ members: DEFAULT_MEMBERS, updatedAt: firebase.firestore.FieldValue.serverTimestamp() });
            }
            unsub = ref.onSnapshot(ds => {
              const data = ds.data();
              if (data?.members) setMembers(data.members);
              setLoading(false);
            });
          } catch (e) {
            console.error(e);
            setError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            setMembers(DEFAULT_MEMBERS);
            setLoading(false);
          }
        })();
        return () => { if (unsub) unsub(); };
      }, []);

      const updateMember = (id, field, value) => {
        const updated = members.map(m => m.id === id ? { ...m, [field]: value } : m);
        setMembers(updated);
        if (!firestore) return;
        clearTimeout(saveTimer.current);
        saveTimer.current = setTimeout(async () => {
          try {
            await firestore.collection(collectionName).doc(docId).update({
              members: updated,
              updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
            });
          } catch (e) { console.error('ì €ì¥ ì‹¤íŒ¨:', e); }
        }, 250);
      };

      const stats = (() => {
        const attending = members.filter(m => m.attendance === 'ì°¸ì„');
        const notAttending = members.filter(m => m.attendance === 'ë¶ˆì°¸');
        const pending = members.filter(m => !m.attendance);
        const totalAttending = attending.reduce((s, m) => s + (parseInt(m.count || '0', 10) || 0), 0);
        return { attending: attending.length, notAttending: notAttending.length, pending: pending.length, totalAttending };
      })();

      if (loading) {
        return <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center"><div className="text-xl text-gray-600">ë¡œë”© ì¤‘...</div></div>;
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
          <div className="max-w-4xl mx-auto">
            {/* í—¤ë” */}
            <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
              <div className="flex items-center justify-between mb-2">
                <div className="flex items-center gap-3">
                  <Calendar className="w-8 h-8 text-indigo-600" />
                  <h1 className="text-3xl font-bold text-gray-800">2025ë…„ ì¶”ê³„ ê³„ëª¨ì„</h1>
                </div>
                <div className="text-right text-sm md:text-base text-indigo-700 font-semibold">
                  ëª¨ì„ì¼ì‹œ : 2025. 11. 22(í† ) 12:00
                </div>
              </div>
              <div className="flex items-center justify-between text-gray-600">
                <p>ì°¸ì„ ì—¬ë¶€ë¥¼ ì„ íƒí•˜ê³  ì¸ì›ìˆ˜ì™€ ë¹„ê³ ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                <div className="text-xs text-gray-400">ì‹¤ì‹œê°„ ì €ì¥</div>
              </div>
            </div>

            {error && (
              <div className="mb-4 p-3 rounded-lg border border-amber-300 bg-amber-50 text-amber-800 text-sm">
                {error}
              </div>
            )}

            {/* í†µê³„ */}
            {/* ì´ ì°¸ì„ ì¸ì› í‘œì‹œ */}
<div className="text-right mb-2 text-lg font-semibold text-indigo-700">  ğŸ‘¥ ì°¸ì„ ì¸ì› ì´ê³„ : {stats.totalAttending}ëª…</div>

<div className="grid grid-cols-3 gap-4 mb-6">
              <div className="bg-green-50 rounded-xl p-4 border-2 border-green-200">
                <div className="flex items-center gap-2 mb-2">
                  <CheckCircle className="w-6 h-6 text-green-600" />
                  <span className="text-lg font-semibold text-green-800">ì°¸ì„</span>
                </div>
                <div className="text-3xl font-bold text-green-600">{stats.attending}ëª…</div>
                <div className="text-sm text-green-700 mt-1">ì´ {stats.totalAttending}ëª…</div>
              </div>
              
              <div className="bg-red-50 rounded-xl p-4 border-2 border-red-200">
                <div className="flex items-center gap-2 mb-2">
                  <XCircle className="w-6 h-6 text-red-600" />
                  <span className="text-lg font-semibold text-red-800">ë¶ˆì°¸</span>
                </div>
                <div className="text-3xl font-bold text-red-600">{stats.notAttending}ëª…</div>
              </div>

              <div className="bg-gray-50 rounded-xl p-4 border-2 border-gray-200">
                <div className="flex items-center gap-2 mb-2">
                  <Users className="w-6 h-6 text-gray-600" />
                  <span className="text-lg font-semibold text-gray-800">ë¯¸ì‘ë‹µ</span>
                </div>
                <div className="text-3xl font-bold text-gray-600">{stats.pending}ëª…</div>
              </div>
            </div>

            {/* í‘œ */}
            <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-indigo-600 text-white">
                    <tr>
                      <th className="px-4 py-3 text-left">ìˆœë²ˆ</th>
                      <th className="px-4 py-3 text-left">íšŒì›ëª…</th>
                      <th className="px-4 py-3 text-center">ì°¸ì„ ì—¬ë¶€</th>
                      <th className="px-4 py-3 text-center">ì¸ì›</th>
                      <th className="px-4 py-3 text-left">ë¹„ê³ </th>
                    </tr>
                  </thead>
                  <tbody>
                    {members.map((m, i) => (
                      <tr key={m.id} className="border-b hover:bg-gray-50 transition">
                        <td className="px-4 py-4 font-semibold text-gray-700">{i + 1}</td>
                        <td className="px-4 py-4 font-medium text-gray-800">{m.name}</td>
                        <td className="px-4 py-4">
                          <div className="flex gap-2 justify-center">
                            <button
                              onClick={() => updateMember(m.id, 'attendance', 'ì°¸ì„')}
                              className={`px-4 py-2 rounded-lg font-medium transition flex items-center gap-1 ${m.attendance === 'ì°¸ì„' ? 'bg-green-500 text-white shadow-md' : 'bg-gray-100 text-gray-600 hover:bg-green-100'}`}
                            >
                              <CheckCircle className="w-4 h-4" /> ì°¸ì„
                            </button>
                            <button
                              onClick={() => updateMember(m.id, 'attendance', 'ë¶ˆì°¸')}
                              className={`px-4 py-2 rounded-lg font-medium transition flex items-center gap-1 ${m.attendance === 'ë¶ˆì°¸' ? 'bg-red-500 text-white shadow-md' : 'bg-gray-100 text-gray-600 hover:bg-red-100'}`}
                            >
                              <XCircle className="w-4 h-4" /> ë¶ˆì°¸
                            </button>
                          </div>
                        </td>
                        <td className="px-4 py-4">
                          <input
                            type="number" min="1"
                            value={m.attendance === 'ë¶ˆì°¸' ? '' : (m.count || '')}
                            onChange={(e) => updateMember(m.id, 'count', e.target.value)}
                            disabled={m.attendance !== 'ì°¸ì„'}
                            placeholder="ì¸ì›"
                            className={`w-20 px-3 py-2 border-2 rounded-lg text-center font-semibold focus:outline-none focus:border-indigo-500 ${m.attendance !== 'ì°¸ì„' ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'border-gray-300 bg-white'}`}
                          />
                        </td>
                        <td className="px-4 py-4">
                          <input
                            type="text" value={m.note || ''}
                            onChange={(e) => updateMember(m.id, 'note', e.target.value)}
                            placeholder="ë¹„ê³ ì‚¬í•­ ì…ë ¥"
                            className="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                          />
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>

            {/* ì•ˆë‚´ */}
            <div className="mt-6 bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4">
              <div className="flex items-start gap-2">
                <Users className="w-5 h-5 text-yellow-600 mt-0.5" />
                <div className="text-sm text-yellow-800">
                  <p className="font-semibold mb-1">ğŸ“¢ ì´ë¬´ ê³µì§€</p>
                  <p>ì°¸ì„ ì—¬ë¶€ì™€ ì¸ì›ìˆ˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì‹œë©´ ì‹ë‹¹ ì˜ˆì•½ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
                  <p className="mt-1">âœ… ë³€ê²½ì‚¬í•­ì€ ìë™ ì €ì¥ Â· ëª¨ë“  ì¸ì›ì´ ì‹¤ì‹œê°„ ê³µìœ ë©ë‹ˆë‹¤.</p>
                  <p className="mt-1">âœ… ì´ ë§í¬ë¥¼ ì¹´í†¡ì— ê³µìœ í•˜ì„¸ìš”. (ë¡œê·¸ì¸ ë¶ˆí•„ìš”)</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<MeetingAttendance />, document.getElementById('root'));
  </script>
</body>
</html>
